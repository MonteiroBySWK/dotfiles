{"version":1,"resource":"file:///home/monteiro/codes/revis/src/lib/business-rules.ts","entries":[{"id":"jntp.ts","source":"Chat Edit: 'Contexto do Projeto\n\nEstamos desenvolvendo um Sistema de Gestão de Estoque para a empresa REVIS, que produz e comercializa bebidas. O sistema substituirá um conjunto de planilhas Excel por uma aplicação web baseada em Firebase (Firestore, Authentication, Cloud Functions), com frontend em Next.js, TypeScript, TailwindCSS e Shadcn/ui.\nFluxo de Negócio (Baseado nas Planilhas)\n\n    Histórico de Vendas → Previsão de demanda\n\n    Montagem Produção → Planejamento de produção considerando sobras de eventos anteriores\n\n    Produção (BOM) → Cálculo de consumo de insumos\n\n    Alertas → Pedidos automáticos baseados em estoque mínimo\n\nModelagem de Dados (Firestore)\n\n    ingredientes: Controle de insumos (matérias-primas) com histórico de movimentações.\n\n    produtos: Drinks prontos, cada um com uma receita (BOM) que lista os insumos e quantidades.\n\n    lotesProducao: Planejamento e execução de produção para um evento, com distribuição automática de quantidades por tipo de drink (REQ-17) e cálculo de consumo (REQ-13).\n\n    pedidos: Pedidos de compra de insumos, com rastreamento de status e anexos.\n\n    eventos: Eventos (feiras, shows) para os quais a produção é planejada.\n\n    vendas: Registro de vendas por evento e ponto de venda (ilhas).\n\nRequisitos Funcionais Principais\n\n    Gestão de Estoque (REQ-01 a REQ-06): Cadastro, movimentação, alertas e controle de perdas.\n\n    Controle de Pedidos (REQ-07 a REQ-11): Criação, rastreamento e recebimento.\n\n    Controle de Produção (REQ-12 a REQ-17): Registro de produção, cálculo de consumo, validade (3 semanas) e FIFO.\n\n    Relatórios (REQ-18): Exportação em Excel, PDF e CSV.\n\nRequisitos Técnicos\n\n    Performance: Consultas em ≤3 segundos, 10 usuários simultâneos, 1000 transações/dia.\n\n    Segurança: Autenticação, níveis de acesso, logs e criptografia.\n\n    Usabilidade: Interface intuitiva, responsiva e acessível.\n\n    Confiabilidade: Alta disponibilidade, backups e recuperação.\n\nDiretrizes de Design\nIdentidade Visual\n\n    Cores: Use a paleta definida (primary: #37D4E6, secondary: #FFFFFF, accent: #F37C87, etc.) via tokens do Tailwind.\n\n    Tipografia: Inter ou Nunito Sans, com hierarquia clara.\n\n    Layout: Grid e Flexbox, responsivo, com foco em desktop e tablets.\n\nComponentização\n\n    Priorize componentes do Shadcn/ui. Estenda ou compose a partir deles.\n\n    Nomeie componentes de forma semântica (ex: HeaderMainPage, CardProductItem).\n\n    Estruture com grid-cols-* e gap-* para layouts de dashboard.\n\nFeedbacks Visuais\n\n    Use cores de feedback (sucesso, erro, aviso, informação) conforme definido.\n\n    Transições suaves (transition-all duration-200).\n\n    Tooltips, skeletons, loaders e mensagens inline.\n\nAcessibilidade\n\n    Contraste WCAG AA, aria-label em elementos interativos, focus-visible para teclado.\n\nRegras de Negócio Críticas\nDistribuição de Produção (REQ-17)\njavascript\n\n// Exemplo de função para distribuir a produção\nfunction calcularDistribuicao(totalDrinks, percentuais) {\n  const distribuicao = {};\n  Object.keys(percentuais).forEach(produtoId => {\n    distribuicao[produtoId] = Math.round(totalDrinks * (percentuais[produtoId] / 100));\n  });\n  return distribuicao;\n}\n\nCálculo de Consumo (REQ-13)\njavascript\n\n// Ao executar a produção, calcular o consumo de insumos baseado na receita (BOM) do produto e nas quantidades produzidas.\n\nControle de Perdas (REQ-06)\njavascript\n\n// Ao ajustar manualmente o estoque, registrar a diferença como perda se houver redução.\n\nFIFO (REQ-16)\njavascript\n\n// Ao vender, consumir primeiro os lotes mais antigos.\n\nAlertas Automáticos\n\n    Estoque abaixo do mínimo (REQ-04) e produtos próximos ao vencimento (REQ-15).\n\nCloud Functions\nAo Executar Produção\n\n    Quando um loteProducao é marcado como \"executado\", atualizar o estoque de insumos subtraindo o consumo calculado.\n\nVerificação de Alertas\n\n    Agendada diariamente para verificar estoques baixos e validades.\n\nDesenvolvimento\nStack\n\n    Frontend: Next.js, TypeScript, TailwindCSS, Shadcn/ui\n\n    Backend: Firebase (Firestore, Authentication, Cloud Functions)\n\n    Estilo: CSS modules ou Tailwind, com tokens de cor definidos.\n\nPrioridades\n\n    Implementar primeiro as funcionalidades ESSENCIAIS (gestão de estoque, produção, pedidos).\n\n    Condicionais: relatórios e análises avançadas.\n\nMigração\n\n    Dados das planilhas Excel existentes devem ser migrados para o Firestore.\n\nAo gerar código, siga estas diretrizes:\n\n    Baseie-se nos componentes do Shadcn/ui e na paleta de cores definida.\n\n    Priorize a legibilidade e a manutenção do código.\n\n    Use TypeScript para tipos e interfaces.\n\n    Estruture os dados de acordo com a modelagem do Firestore.\n\n    Implemente as regras de negócio conforme descrito.\n\n    Garanta a responsividade e acessibilidade.\n\n    Documente componentes e funções complexas.\n\nExemplo de nomenclatura de componentes:\n\n    HeaderMainPage, SidebarNavigation, TableProductList, ModalConfirmAction\n\nExemplo de estrutura de pasta:\ntext\n\n/src\n  /components\n    /ui\n    /layout\n    /production\n    /inventory\n  /lib\n  /hooks\n  /types'","timestamp":1762722596848}]}